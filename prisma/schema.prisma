generator client {
  provider     = "prisma-client-js"
  engineType   = "binary"
  binaryTargets = ["native"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DATABASE_URL")
}

model User {
  id          Int      @id @default(autoincrement())
  userName    String   @unique
  wbEmailId   String?  @unique
  password    String
  phoneNumber String?
  role        Role     @default(SALES)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Agreement {
  id              Int            @id @default(autoincrement())
  clientName      String
  employeeName    String?
  type            AgreementType?
  poNumber        Int?
  startDate       DateTime?
  endDate         DateTime?
  fileUpload      String?
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  technology      Technology?
  otherTechnology String?
}

enum Priority {
  Low
  Medium
  High
}

model Requirement {
  id              Int      @id @default(autoincrement())
  requirementId   String   @unique
  requirementName String
  companyName     String
  jobDescription  String
  experience      Int
  noticePeriod    Int
  positions       Int
  primarySkills   String
  secondarySkills String
  closePositions  String
  requirementType String
  workLocation    String
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  jdImage         String?
  budget          Int?
  priority        Priority @default(Medium)
  updatedBy      String?
}

model Lead {
  id                     Int                @id @default(autoincrement())
  salesName              String
  companyName            String             @unique
  numberOfEmployees      Int                @default(0)
  employeeName           String[]
  replacementToDate      DateTime?
  replacementRequestDate DateTime?
  createdAt              DateTime           @default(now())
  updatedAt              DateTime           @updatedAt
  status                 LeadStatus         @default(prospective)
  companyNameGST         String?
  companySelect          String?
  companysize            String?
  industry               Industry?
  percentage             Int?
  remarks                String?
  technology             Technology?
  replacementReason      ReplacementReason?
  businessType           String?
  companyID              String?            @unique
  technologyOther        String?
  leadType               LeadType
  companyType            String?
  spocs                  Spoc[]
  reminders              Reminder[]
}

model Spoc {
  id          Int        @id @default(autoincrement())
  name        String
  email       String
  contact     String
  altContact  String?
  designation String
  location    String
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  leadId      Int
  lead        Lead       @relation(fields: [leadId], references: [id])
  reminders   Reminder[]
}

model Device {
  id             String     @id @default(uuid())
  slNo           String
  employeeId     String
  employeeName   String
  employeeStatus String
  projectWorking String
  deviceType     DeviceType
  modelName      String
  deviceId       String     @unique
  deviceStatus   String
  assignedDate   DateTime
  processor      String?
  ram            String?
  storage        String?
  osVersion      String?
  accessories    String?
  warrantyExpiry DateTime?
  color          String?
  config         String?
  imeiNumber     String?    @unique
  phoneNumber    String?
  simCardNumber  String?
  carrier        String?
  mdmEnrolled    Boolean?
  remarks        String?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
}

model Candidate {
  id                     Int      @id @default(autoincrement())
  name                   String
  contactNumber          String
  alternateContactNumber String?
  email                  String
  sourcedFrom            String?
  employmentType         String?
  domainExperience       String?
  company                String?
  role                   String?
  currentCTC             Float?
  expectedCTC            Float?
  workingStatus          String?
  noticePeriod           Int?
  location               String?
  relocate               Boolean?
  preferredLocation      String?
  interviewAvailability  String?
  clientName             String?
  demandCode             String?
  interviewTakenBy       String?
  comments               String[]
  status                 String?
  followUps              String?
  updatedBy              String?
  offersAny              Boolean
  screeningComment       String?
  technicalSkills        String
  relevantExperience     String
  primarySkillExp        String?
  secondarySkillExp      String?
  nammaqaUpdate          String?
  clientInterviewStatus  String?
  feedback               String?
  resumeLink             String?
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt
  offerDetails           String?
  acmanagerStatus        String?
  acupdateby             String?
}

model Reminder {
  id               Int      @id @default(autoincrement())
  clientId         Int
  companyName      String
  phoneNumber      String?
  followUpDateTime DateTime
  notes            String?
  completed        Boolean  @default(false)
  spocId           Int? // Optional - can have reminders without specific SPOC
  spoc             Spoc?    @relation(fields: [spocId], references: [id])
  creatorEmail     String // Email of the user who created the reminder
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  lead             Lead     @relation(fields: [clientId], references: [id])
}

enum Role {
  ADMIN
  RECRUITER
  SALES
  ACCOUNT_MANAGER
  SUPERADMIN
  INVOICE
  IT_ADMIN
}

enum AgreementType {
  MSA
  NDA
  SOW
  PO
}

enum LeadStatus {
  prospective
  newlead
  existing
  deal
  NEW
}

enum LeadType {
  prospective
  new
  existing
  deal
}

enum ReplacementReason {
  resigned
  performance_issue
  employee_concern
}

enum Technology {
  development
  testing
  devops
  ai_ml
  ai
  other
  digital_marketing
  data_analytics
}

enum Industry {
  it
  finance
  healthcare
  manufacturing
  retail
  education
  telecom
  automobile
  realestate
  logistics
  media
  government
  energy
  consulting
  other
}

enum DeviceType {
  LAPTOP
  MOBILE
}

enum CustomerType {
  BUSINESS
  INDIVIDUAL
}

enum PaymentTerms {
  NET_15
  NET_30
  NET_45
  NET_60
  DUE_ON_RECEIPT
  DUE_END_OF_MONTH
  DUE_END_OF_NEXT_MONTH
}

model Customer {
  id                Int             @id @default(autoincrement())
  customerType      CustomerType?
  primaryContact    String
  companyName       String?
  displayName       String
  currency          String?
  emailAddress      String
  phoneNumberWork   String?
  phoneNumberMobile String?
  pan               String?
  paymentTerms      PaymentTerms
  documents         String[]
  department        String?
  designation       String?
  website           String?
  billingAttention  String?
  billingCountry    String?         @default("India")
  billingAddress    String
  billingCity       String
  billingState      String
  billingPinCode    String
  billingPhone      String?
  billingFax        String?
  gstNumber         String?
  gstTreatment      String?
  shippingAttention String?
  shippingCountry   String?
  shippingAddress   String?
  shippingCity      String?
  shippingState     String?
  shippingPinCode   String?
  shippingPhone     String?
  placeOfSupply     String?
  shippingFax       String?
  remarks           String?
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  ContactPerson     ContactPerson[]

  Invoice Invoice[]
}

model ContactPerson {
  id           Int      @id @default(autoincrement())
  customerId   Int
  customer     Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  salutation   String?
  firstName    String
  lastName     String
  emailAddress String
  workPhone    String?
  mobile       String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Invoice {
  id                Int           @id @default(autoincrement())
  customerId        Int
  customer          Customer      @relation(fields: [customerId], references: [id], onDelete: Cascade)
  invoiceCode       String?       @unique
  invoiceDate       DateTime?
  terms             PaymentTerms?
  dueDate           DateTime?
  poNumber          String?
  customerNotes     String?
  total             Float?
  Documents         String[]
  status            String?       @default("Draft")
  isDraft           Boolean       @default(true)
  gstNumber         String?
  gstTreatment      String?
  placeOfSupply     String?
  paymentMode       String?
  paymentDate       DateTime?
  referenceNumber   String?
  notes             String?
  bankCharges       Float?
  pan               String?
  taxDeducted       Boolean?
  paymentReceivedOn DateTime?
  invoiceTemplate   String?
  amountReceived    Float?
  paymentDocuments  String[]
  paymentId         String?
  balancedDue       Float?        @default(0)
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt
  writeofdate       DateTime?
  writeofnotes      String?
  writeofamount     Float?
  Item              Item[]
}

model Item {
  id                 Int      @id @default(autoincrement())
  invoiceId          Int
  invoice            Invoice  @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  itemDetails        String
  quantity           Int
  rate               Float
  amount             Float
  sac                String?
  discountPercentage Float?
  GstPercentage      Float?
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
}

model Expense {
  id          Int      @id @default(autoincrement())
  date        DateTime
  item        String
  description String?
  amount      Float
  attachment  String? // File URL or path
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Inventory {
  id                 Int       @id @default(autoincrement())
  serialNumber       String    @unique
  itemName           String
  itemQuantity       Int
  produceBroughtDate DateTime
  dateOfTakeForUse   DateTime?
  quantityBalance    Int
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt

  @@map("inventory")
}
